<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ± - Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: #f5f5f5;
        }

        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px 20px 20px;
            text-align: center;
        }
        
        .header-section h1 {
            font-size: 1.8em;
            margin-bottom: 15px;
        }
        
        .stats-banner {
            background: linear-gradient(90deg, #ffe5b4 0%, #ffd89b 100%);
            padding: 20px;
            color: #8b4513;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stats-main {
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 12px;
        }
        
        .content-section {
            background: #f5f5f5;
            min-height: calc(100vh - 400px);
            padding: 40px 20px;
        }
        
        .section-title {
            font-size: 2em;
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .table-wrapper {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin: 20px auto;
            max-width: 1400px;
            background: white;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        th {
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            font-size: 0.95em;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        
        td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
        }
        
        tbody tr:hover {
            background: #f8f9fa;
        }
        
        .highlight-top {
            background: #fff3e0;
            font-weight: bold;
        }
        
        .info-card {
            background: white;
            border-left: 5px solid #667eea;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 1400px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .stat-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin: 20px auto;
            max-width: 1400px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-section h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            text-align: center;
        }
        
        .stat-card .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 8px;
        }
        
        .stat-card .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
        }
        
        .rank-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .rank-1 { background: #ffd700; color: #8b4513; }
        .rank-2 { background: #c0c0c0; color: #333; }
        .rank-3 { background: #cd7f32; color: white; }
        .rank-other { background: #e0e0e0; color: #666; }
        
        @media (max-width: 768px) {
            .header-section h1 { font-size: 1.5em; }
            .table-wrapper { font-size: 0.85em; }
        }
    </style>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div id="loadingScreen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(102, 126, 234, 0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; color: white;">
        <div style="font-size: 3em; margin-bottom: 20px;">ğŸ“Š</div>
        <div style="font-size: 1.5em; margin-bottom: 10px;">æ­£åœ¨è¼‰å…¥è³‡æ–™...</div>
    </div>

    <div class="header-section">
        <h1>CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ±</h1>
        <div style="font-size: 1em; opacity: 0.95; margin-top: 10px;">by Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</div>
    </div>

    <div class="stats-banner">
        <div class="stats-main" id="statsBanner">ğŸ“Š è³‡æ–™è¼‰å…¥ä¸­...</div>
    </div>

    <div class="content-section">
        <div class="section-title">ğŸ“Š å¸‚å ´çµ±è¨ˆåˆ†æ</div>
        
        <div class="info-card">
            <div style="font-weight: bold; color: #1565c0; margin-bottom: 10px;">ğŸ’¡ çµ±è¨ˆèªªæ˜</div>
            <div style="color: #0d47a1; line-height: 1.6;">æœ¬ç³»çµ±æä¾›å¤šç¶­åº¦çš„CBå¸‚å ´çµ±è¨ˆåˆ†æ,åŒ…å«ç™¼è¡Œè¦æ¨¡ã€è‚¡æœ¬å¤§å°ã€è½‰æ›åƒ¹æ ¼ç­‰å€é–“çµ±è¨ˆ,ä»¥åŠåˆ¸å•†å’Œç”¢æ¥­çš„è¡¨ç¾æ’åã€‚æ‰€æœ‰æ•¸æ“šä¾æ›ç‰Œæœ€é«˜åƒ¹ç”±å¥½åˆ°å·®æ’åºã€‚</div>
        </div>

        <!-- æ•´é«”æ¦‚æ³ -->
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; margin: 20px auto; max-width: 1400px;">
            <h3 style="margin-bottom: 20px; font-size: 1.4em;">ğŸŒ å¸‚å ´æ•´é«”æ¦‚æ³</h3>
            <div class="stats-grid">
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; opacity: 0.9;">CBç¸½æ•¸</div>
                    <div id="totalCount" style="font-size: 2.2em; font-weight: bold; margin-top: 8px;">-</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; opacity: 0.9;">ç¸½ç™¼è¡Œè¦æ¨¡</div>
                    <div id="totalSize" style="font-size: 2.2em; font-weight: bold; margin-top: 8px;">-</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æœ€é«˜åƒ¹</div>
                    <div id="avgHighAll" style="font-size: 2.2em; font-weight: bold; margin-top: 8px;">-</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æŒ¯å¹…</div>
                    <div id="avgSwingAll" style="font-size: 2.2em; font-weight: bold; margin-top: 8px;">-</div>
                </div>
            </div>
        </div>

        <!-- åŸºæœ¬åˆ†é¡çµ±è¨ˆ -->
        <div class="stat-section">
            <h3>ğŸ“‹ åŸºæœ¬åˆ†é¡çµ±è¨ˆæ¯”è¼ƒ</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>åˆ†é¡æ¢ä»¶</th>
                            <th>CBæ•¸é‡</th>
                            <th>ç¸½è¦æ¨¡(å„„)</th>
                            <th>å¹³å‡è¦æ¨¡(å„„)</th>
                            <th>å¹³å‡æœ€é«˜åƒ¹</th>
                            <th>å¹³å‡æœ€ä½åƒ¹</th>
                            <th>å¹³å‡æŒ¯å¹…(%)</th>
                        </tr>
                    </thead>
                    <tbody id="basicStatsTable"></tbody>
                </table>
            </div>
        </div>

        <!-- ç™¼è¡Œè¦æ¨¡å€é–“çµ±è¨ˆ -->
        <div class="stat-section">
            <h3>ğŸ’¼ ç™¼è¡Œè¦æ¨¡å€é–“çµ±è¨ˆ (ä¾å¹³å‡æœ€é«˜åƒ¹æ’åº)</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>è¦æ¨¡å€é–“</th>
                            <th>CBæ•¸é‡</th>
                            <th>å¹³å‡è¦æ¨¡(å„„)</th>
                            <th style="background: #ff6b6b;">å¹³å‡æœ€é«˜åƒ¹</th>
                            <th>å¹³å‡æœ€ä½åƒ¹</th>
                            <th>å¹³å‡æŒ¯å¹…(%)</th>
                        </tr>
                    </thead>
                    <tbody id="sizeRangeTable"></tbody>
                </table>
            </div>
            <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 8px; font-size: 0.9em;">
                <strong>ğŸ’¡ è§€å¯Ÿé‡é»:</strong> æ­¤è¡¨ä¾å¹³å‡æœ€é«˜åƒ¹ç”±é«˜åˆ°ä½æ’åº,å¯è§€å¯Ÿä¸åŒè¦æ¨¡CBçš„æ›ç‰Œè¡¨ç¾å·®ç•°
            </div>
        </div>

        <!-- è‚¡æœ¬å¤§å°å€é–“çµ±è¨ˆ -->
        <div class="stat-section">
            <h3>ğŸ¦ è‚¡æœ¬å¤§å°å€é–“çµ±è¨ˆ (ä¾å¹³å‡æœ€é«˜åƒ¹æ’åº)</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>è‚¡æœ¬å€é–“</th>
                            <th>CBæ•¸é‡</th>
                            <th>å¹³å‡è¦æ¨¡(å„„)</th>
                            <th style="background: #ff6b6b;">å¹³å‡æœ€é«˜åƒ¹</th>
                            <th>å¹³å‡æœ€ä½åƒ¹</th>
                            <th>å¹³å‡æŒ¯å¹…(%)</th>
                        </tr>
                    </thead>
                    <tbody id="capitalRangeTable"></tbody>
                </table>
            </div>
            <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 8px; font-size: 0.9em;">
                <strong>ğŸ’¡ è§€å¯Ÿé‡é»:</strong> å¯è§€å¯Ÿå…¬å¸è‚¡æœ¬è¦æ¨¡èˆ‡CBæ›ç‰Œè¡¨ç¾çš„é—œä¿‚
            </div>
        </div>

        <!-- è½‰æ›åƒ¹æ ¼å€é–“çµ±è¨ˆ -->
        <div class="stat-section">
            <h3>ğŸ’° è½‰æ›åƒ¹æ ¼å€é–“çµ±è¨ˆ (ä¾å¹³å‡æœ€é«˜åƒ¹æ’åº)</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>è½‰æ›åƒ¹æ ¼å€é–“</th>
                            <th>CBæ•¸é‡</th>
                            <th>å¹³å‡è¦æ¨¡(å„„)</th>
                            <th style="background: #ff6b6b;">å¹³å‡æœ€é«˜åƒ¹</th>
                            <th>å¹³å‡æœ€ä½åƒ¹</th>
                            <th>å¹³å‡æŒ¯å¹…(%)</th>
                        </tr>
                    </thead>
                    <tbody id="convPriceRangeTable"></tbody>
                </table>
            </div>
            <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 8px; font-size: 0.9em;">
                <strong>ğŸ’¡ è§€å¯Ÿé‡é»:</strong> è½‰æ›åƒ¹æ ¼é«˜ä½èˆ‡æ›ç‰Œè¡¨ç¾çš„é—œè¯æ€§åˆ†æ
            </div>
        </div>

        <!-- åˆ¸å•†TOP10 -->
        <div class="stat-section">
            <h3>ğŸ† æ‰¿éŠ·åˆ¸å•†è¡¨ç¾æ’è¡Œ TOP 10</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>åˆ¸å•†åç¨±</th>
                            <th>ç™¼è¡Œæ•¸é‡</th>
                            <th>ç¸½è¦æ¨¡(å„„)</th>
                            <th>å¹³å‡è¦æ¨¡(å„„)</th>
                            <th style="background: #ff6b6b;">å¹³å‡æœ€é«˜åƒ¹</th>
                            <th>å¹³å‡æœ€ä½åƒ¹</th>
                            <th>å¹³å‡æŒ¯å¹…(%)</th>
                        </tr>
                    </thead>
                    <tbody id="underwriterTop10Table"></tbody>
                </table>
            </div>
            <div style="margin-top: 15px; padding: 15px; background: #fff3e0; border-radius: 8px; font-size: 0.9em;">
                <strong>ğŸ’¡ è§€å¯Ÿé‡é»:</strong> æ­¤æ’ååƒ…å‘ˆç¾æ•¸æ“šçµ±è¨ˆ,ä¸ä»£è¡¨æœªä¾†è¡¨ç¾ã€‚å„åˆ¸å•†æ‰¿ä½œçš„CBç”¢æ¥­é¡åˆ¥ã€å…¬å¸è¦æ¨¡ç­‰æ¢ä»¶ä¸åŒ,éœ€ç¶œåˆè©•ä¼°
            </div>
        </div>

        <!-- ç”¢æ¥­TOP10 -->
        <div class="stat-section">
            <h3>ğŸ­ ç”¢æ¥­è¡¨ç¾æ’è¡Œ TOP 10</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>ç”¢æ¥­åˆ†é¡</th>
                            <th>ç™¼è¡Œæ•¸é‡</th>
                            <th>ç¸½è¦æ¨¡(å„„)</th>
                            <th>å¹³å‡è¦æ¨¡(å„„)</th>
                            <th style="background: #ff6b6b;">å¹³å‡æœ€é«˜åƒ¹</th>
                            <th>å¹³å‡æœ€ä½åƒ¹</th>
                            <th>å¹³å‡æŒ¯å¹…(%)</th>
                        </tr>
                    </thead>
                    <tbody id="industryTop10Table"></tbody>
                </table>
            </div>
            <div style="margin-top: 15px; padding: 15px; background: #fff3e0; border-radius: 8px; font-size: 0.9em;">
                <strong>ğŸ’¡ è§€å¯Ÿé‡é»:</strong> ç”¢æ¥­æ™¯æ°£å¾ªç’°ã€å¸‚å ´ç’°å¢ƒç­‰å› ç´ æœƒå½±éŸ¿CBè¡¨ç¾,æ­·å²æ•¸æ“šåƒ…ä¾›åƒè€ƒ
            </div>
        </div>

        <!-- æ“”ä¿é¡å‹äº¤å‰åˆ†æ -->
        <div class="stat-section">
            <h3>ğŸ”€ æ“”ä¿/ç„¡æ“”ä¿äº¤å‰åˆ†æ</h3>
            
            <!-- ç”¢æ¥­å‰ååçš„æ“”ä¿äº¤å‰ -->
            <h4 style="background: #f8f9fa; padding: 12px; border-left: 4px solid #667eea; margin: 20px 0 15px;">
                ğŸ­ ç”¢æ¥­TOP10 - æ“”ä¿/ç„¡æ“”ä¿å°æ¯”
            </h4>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>ç”¢æ¥­</th>
                            <th>å…¨éƒ¨æ•¸æ“š</th>
                            <th>æœ‰æ“”ä¿</th>
                            <th>ç„¡æ“”ä¿</th>
                        </tr>
                    </thead>
                    <tbody id="industryGuaranteeTable"></tbody>
                </table>
            </div>
            
            <!-- åˆ¸å•†å‰ååçš„æ“”ä¿äº¤å‰ -->
            <h4 style="background: #f8f9fa; padding: 12px; border-left: 4px solid #667eea; margin: 20px 0 15px;">
                ğŸ¦ åˆ¸å•†TOP10 - æ“”ä¿/ç„¡æ“”ä¿å°æ¯”
            </h4>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>åˆ¸å•†</th>
                            <th>å…¨éƒ¨æ•¸æ“š</th>
                            <th>æœ‰æ“”ä¿</th>
                            <th>ç„¡æ“”ä¿</th>
                        </tr>
                    </thead>
                    <tbody id="underwriterGuaranteeTable"></tbody>
                </table>
            </div>
            
            <div style="margin-top: 15px; padding: 15px; background: #e8f5e9; border-radius: 8px; font-size: 0.9em;">
                <strong>ğŸ’¡ åˆ†æèªªæ˜:</strong> å¯è§€å¯ŸåŒä¸€ç”¢æ¥­æˆ–åˆ¸å•†åœ¨æœ‰æ“”ä¿èˆ‡ç„¡æ“”ä¿CBçš„è¡¨ç¾å·®ç•°,äº†è§£æ“”ä¿æ¢ä»¶å°æ›ç‰Œè¡¨ç¾çš„å½±éŸ¿
            </div>
        </div>

    </div>

    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 20px; margin-top: 40px;">
        <p>Â© 2025 Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤ | CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ±</p>
        <p style="margin-top: 8px; opacity: 0.9;">è³‡æ–™åƒ…ä¾›åƒè€ƒ | æŠ•è³‡æœ‰é¢¨éšª,å…¥å¸‚éœ€è¬¹æ…</p>
    </div>

    <script>
        let mockData = [];
        
        function formatNumber(num) {
            if (num === '-' || num === '' || num === null || num === undefined) return '-';
            const n = parseFloat(num);
            if (isNaN(n)) return '-';
            return n.toFixed(1);
        }
        
        function calculateStats(data) {
            if (data.length === 0) return null;
            const count = data.length;
            const totalSize = data.reduce((s, d) => s + (d.size || 0), 0);
            const avgSize = totalSize / count;
            const avgHigh = data.reduce((s, d) => s + (d.high || 0), 0) / count;
            const avgLow = data.reduce((s, d) => s + (d.low || 0), 0) / count;
            const avgSwing = data.reduce((s, d) => {
                if (d.low > 0) return s + ((d.high - d.low) / d.low * 100);
                return s;
            }, 0) / count;
            return { count, totalSize, avgSize, avgHigh, avgLow, avgSwing };
        }
        
        function getRankBadge(rank) {
            if (rank === 1) return '<span class="rank-badge rank-1">ğŸ¥‡</span>';
            if (rank === 2) return '<span class="rank-badge rank-2">ğŸ¥ˆ</span>';
            if (rank === 3) return '<span class="rank-badge rank-3">ğŸ¥‰</span>';
            return '<span class="rank-badge rank-other">' + rank + '</span>';
        }
        
        function generateBasicStats() {
            const tbody = document.getElementById('basicStatsTable');
            tbody.innerHTML = '';
            
            // å…¨éƒ¨CB
            const all = calculateStats(mockData);
            tbody.innerHTML += `<tr style="background: #f8f9fa; font-weight: bold;">
                <td>ğŸ“Š å…¨éƒ¨CB</td><td>${all.count}</td><td>${all.totalSize.toFixed(1)}</td>
                <td>${all.avgSize.toFixed(1)}</td><td>${all.avgHigh.toFixed(1)}</td>
                <td>${all.avgLow.toFixed(1)}</td><td>${all.avgSwing.toFixed(1)}</td></tr>`;
            
            // è¦æ¨¡åˆ†é¡
            const large = calculateStats(mockData.filter(d => d.size >= 10));
            const small = calculateStats(mockData.filter(d => d.size < 10));
            tbody.innerHTML += `<tr><td>ğŸ’¼ è¦æ¨¡â‰¥10å„„</td><td>${large.count}</td><td>${large.totalSize.toFixed(1)}</td>
                <td>${large.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${large.avgHigh.toFixed(1)}</td>
                <td>${large.avgLow.toFixed(1)}</td><td>${large.avgSwing.toFixed(1)}</td></tr>`;
            tbody.innerHTML += `<tr><td>ğŸ’¼ è¦æ¨¡<10å„„</td><td>${small.count}</td><td>${small.totalSize.toFixed(1)}</td>
                <td>${small.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${small.avgHigh.toFixed(1)}</td>
                <td>${small.avgLow.toFixed(1)}</td><td>${small.avgSwing.toFixed(1)}</td></tr>`;
            
            // æ‰¿éŠ·æ–¹å¼
            const inquiry = calculateStats(mockData.filter(d => d.method === 'è©¢åœˆ'));
            const auction = calculateStats(mockData.filter(d => d.method === 'ç«¶æ‹'));
            if (inquiry) {
                tbody.innerHTML += `<tr><td>ğŸ¯ è©¢åœˆ</td><td>${inquiry.count}</td><td>${inquiry.totalSize.toFixed(1)}</td>
                    <td>${inquiry.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${inquiry.avgHigh.toFixed(1)}</td>
                    <td>${inquiry.avgLow.toFixed(1)}</td><td>${inquiry.avgSwing.toFixed(1)}</td></tr>`;
            }
            if (auction) {
                tbody.innerHTML += `<tr><td>ğŸ¯ ç«¶æ‹</td><td>${auction.count}</td><td>${auction.totalSize.toFixed(1)}</td>
                    <td>${auction.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${auction.avgHigh.toFixed(1)}</td>
                    <td>${auction.avgLow.toFixed(1)}</td><td>${auction.avgSwing.toFixed(1)}</td></tr>`;
            }
            
            // è½‰æ›åƒ¹æ ¼åˆ†é¡
            const highPrice = calculateStats(mockData.filter(d => d.convPrice >= 100));
            const lowPrice = calculateStats(mockData.filter(d => d.convPrice < 100 && d.convPrice > 0));
            if (highPrice) {
                tbody.innerHTML += `<tr><td>ğŸ’° è½‰æ›åƒ¹â‰¥100å…ƒ</td><td>${highPrice.count}</td><td>${highPrice.totalSize.toFixed(1)}</td>
                    <td>${highPrice.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${highPrice.avgHigh.toFixed(1)}</td>
                    <td>${highPrice.avgLow.toFixed(1)}</td><td>${highPrice.avgSwing.toFixed(1)}</td></tr>`;
            }
            if (lowPrice) {
                tbody.innerHTML += `<tr><td>ğŸ’° è½‰æ›åƒ¹<100å…ƒ</td><td>${lowPrice.count}</td><td>${lowPrice.totalSize.toFixed(1)}</td>
                    <td>${lowPrice.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${lowPrice.avgHigh.toFixed(1)}</td>
                    <td>${lowPrice.avgLow.toFixed(1)}</td><td>${lowPrice.avgSwing.toFixed(1)}</td></tr>`;
            }
            
            // è‚¡æœ¬åˆ†é¡
            const largeCapital = calculateStats(mockData.filter(d => parseFloat(d.capital) >= 10));
            const smallCapital = calculateStats(mockData.filter(d => parseFloat(d.capital) < 10 && parseFloat(d.capital) > 0));
            if (largeCapital) {
                tbody.innerHTML += `<tr><td>ğŸ¦ è‚¡æœ¬â‰¥10å„„</td><td>${largeCapital.count}</td><td>${largeCapital.totalSize.toFixed(1)}</td>
                    <td>${largeCapital.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${largeCapital.avgHigh.toFixed(1)}</td>
                    <td>${largeCapital.avgLow.toFixed(1)}</td><td>${largeCapital.avgSwing.toFixed(1)}</td></tr>`;
            }
            if (smallCapital) {
                tbody.innerHTML += `<tr><td>ğŸ¦ è‚¡æœ¬<10å„„</td><td>${smallCapital.count}</td><td>${smallCapital.totalSize.toFixed(1)}</td>
                    <td>${smallCapital.avgSize.toFixed(1)}</td><td style="color: #d32f2f; font-weight: bold;">${smallCapital.avgHigh.toFixed(1)}</td>
                    <td>${smallCapital.avgLow.toFixed(1)}</td><td>${smallCapital.avgSwing.toFixed(1)}</td></tr>`;
            }
        }
        
        function generateSizeRangeStats() {
            const ranges = [
                { label: '2å„„ä»¥ä¸‹', min: 0, max: 2 },
                { label: '2-5å„„', min: 2, max: 5 },
                { label: '5-10å„„', min: 5, max: 10 },
                { label: '10-15å„„', min: 10, max: 15 },
                { label: '15-20å„„', min: 15, max: 20 },
                { label: '20å„„ä»¥ä¸Š', min: 20, max: 9999 }
            ];
            
            const rangeStats = ranges.map(range => {
                const data = mockData.filter(d => d.size >= range.min && d.size < range.max);
                const stats = calculateStats(data);
                return { label: range.label, ...stats };
            }).filter(s => s && s.count > 0);
            
            // ä¾å¹³å‡æœ€é«˜åƒ¹æ’åº,å–å‰6é …
            rangeStats.sort((a, b) => b.avgHigh - a.avgHigh);
            const top6 = rangeStats.slice(0, 6);
            
            const tbody = document.getElementById('sizeRangeTable');
            tbody.innerHTML = top6.map((stat, index) => {
                const rowClass = index < 3 ? 'highlight-top' : '';
                return `<tr class="${rowClass}">
                    <td>${getRankBadge(index + 1)}</td>
                    <td style="text-align: left; padding-left: 15px;">${stat.label}</td>
                    <td>${stat.count}</td>
                    <td>${stat.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold; font-size: 1.1em;">${stat.avgHigh.toFixed(1)}</td>
                    <td>${stat.avgLow.toFixed(1)}</td>
                    <td>${stat.avgSwing.toFixed(1)}</td>
                </tr>`;
            }).join('');
        }
        
        function generateCapitalRangeStats() {
            const ranges = [
                { label: '3å„„ä»¥ä¸‹', min: 0, max: 3 },
                { label: '3-6å„„', min: 3, max: 6 },
                { label: '6-10å„„', min: 6, max: 10 },
                { label: '10-15å„„', min: 10, max: 15 },
                { label: '15-20å„„', min: 15, max: 20 },
                { label: '20å„„ä»¥ä¸Š', min: 20, max: 9999 }
            ];
            
            const rangeStats = ranges.map(range => {
                const data = mockData.filter(d => {
                    const cap = parseFloat(d.capital);
                    return cap >= range.min && cap < range.max;
                });
                const stats = calculateStats(data);
                return { label: range.label, ...stats };
            }).filter(s => s && s.count > 0);
            
            rangeStats.sort((a, b) => b.avgHigh - a.avgHigh);
            const top6 = rangeStats.slice(0, 6);
            
            const tbody = document.getElementById('capitalRangeTable');
            tbody.innerHTML = top6.map((stat, index) => {
                const rowClass = index < 3 ? 'highlight-top' : '';
                return `<tr class="${rowClass}">
                    <td>${getRankBadge(index + 1)}</td>
                    <td style="text-align: left; padding-left: 15px;">${stat.label}</td>
                    <td>${stat.count}</td>
                    <td>${stat.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold; font-size: 1.1em;">${stat.avgHigh.toFixed(1)}</td>
                    <td>${stat.avgLow.toFixed(1)}</td>
                    <td>${stat.avgSwing.toFixed(1)}</td>
                </tr>`;
            }).join('');
        }
        
        function generateConvPriceRangeStats() {
            const ranges = [
                { label: '20å…ƒä»¥ä¸‹', min: 0, max: 20 },
                { label: '20-50å…ƒ', min: 20, max: 50 },
                { label: '50-100å…ƒ', min: 50, max: 100 },
                { label: '100-150å…ƒ', min: 100, max: 150 },
                { label: '150-200å…ƒ', min: 150, max: 200 },
                { label: '200å…ƒä»¥ä¸Š', min: 200, max: 9999 }
            ];
            
            const rangeStats = ranges.map(range => {
                const data = mockData.filter(d => d.convPrice >= range.min && d.convPrice < range.max);
                const stats = calculateStats(data);
                return { label: range.label, ...stats };
            }).filter(s => s && s.count > 0);
            
            rangeStats.sort((a, b) => b.avgHigh - a.avgHigh);
            const top6 = rangeStats.slice(0, 6);
            
            const tbody = document.getElementById('convPriceRangeTable');
            tbody.innerHTML = top6.map((stat, index) => {
                const rowClass = index < 3 ? 'highlight-top' : '';
                return `<tr class="${rowClass}">
                    <td>${getRankBadge(index + 1)}</td>
                    <td style="text-align: left; padding-left: 15px;">${stat.label}</td>
                    <td>${stat.count}</td>
                    <td>${stat.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold; font-size: 1.1em;">${stat.avgHigh.toFixed(1)}</td>
                    <td>${stat.avgLow.toFixed(1)}</td>
                    <td>${stat.avgSwing.toFixed(1)}</td>
                </tr>`;
            }).join('');
        }
        
        function generateUnderwriterTop10() {
            const underwriters = [...new Set(mockData.map(d => d.underwriter))];
            const uwStats = underwriters.map(uw => {
                const data = mockData.filter(d => d.underwriter === uw);
                const stats = calculateStats(data);
                return { name: uw, ...stats };
            }).filter(s => s && s.count > 0);
            
            uwStats.sort((a, b) => b.avgHigh - a.avgHigh);
            const top10 = uwStats.slice(0, 10);
            
            const tbody = document.getElementById('underwriterTop10Table');
            tbody.innerHTML = top10.map((stat, index) => {
                const rowClass = index < 3 ? 'highlight-top' : '';
                return `<tr class="${rowClass}">
                    <td>${getRankBadge(index + 1)}</td>
                    <td style="text-align: left; padding-left: 15px;">${stat.name}</td>
                    <td>${stat.count}</td>
                    <td>${stat.totalSize.toFixed(1)}</td>
                    <td>${stat.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold; font-size: 1.1em;">${stat.avgHigh.toFixed(1)}</td>
                    <td>${stat.avgLow.toFixed(1)}</td>
                    <td>${stat.avgSwing.toFixed(1)}</td>
                </tr>`;
            }).join('');
        }
        
        function generateIndustryTop10() {
            const industries = [...new Set(mockData.map(d => d.industry))];
            const indStats = industries.map(ind => {
                const data = mockData.filter(d => d.industry === ind);
                const stats = calculateStats(data);
                return { name: ind, ...stats };
            }).filter(s => s && s.count > 0);
            
            indStats.sort((a, b) => b.avgHigh - a.avgHigh);
            const top10 = indStats.slice(0, 10);
            
            const tbody = document.getElementById('industryTop10Table');
            tbody.innerHTML = top10.map((stat, index) => {
                const rowClass = index < 3 ? 'highlight-top' : '';
                return `<tr class="${rowClass}">
                    <td>${getRankBadge(index + 1)}</td>
                    <td style="text-align: left; padding-left: 15px;">${stat.name}</td>
                    <td>${stat.count}</td>
                    <td>${stat.totalSize.toFixed(1)}</td>
                    <td>${stat.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold; font-size: 1.1em;">${stat.avgHigh.toFixed(1)}</td>
                    <td>${stat.avgLow.toFixed(1)}</td>
                    <td>${stat.avgSwing.toFixed(1)}</td>
                </tr>`;
            }).join('');
        }
        
        function generateCrossAnalysis() {
            // ç”¢æ¥­TOP10çš„æ“”ä¿äº¤å‰åˆ†æ
            const industries = [...new Set(mockData.map(d => d.industry))];
            const indStats = industries.map(ind => {
                const all = mockData.filter(d => d.industry === ind);
                const guaranteed = all.filter(d => d.guarantee === 'æœ‰æ“”ä¿');
                const notGuaranteed = all.filter(d => d.guarantee === 'ç„¡æ“”ä¿');
                return {
                    name: ind,
                    all: calculateStats(all),
                    guaranteed: calculateStats(guaranteed),
                    notGuaranteed: calculateStats(notGuaranteed)
                };
            }).filter(s => s.all && s.all.count > 0);
            
            indStats.sort((a, b) => b.all.avgHigh - a.all.avgHigh);
            const top10Ind = indStats.slice(0, 10);
            
            const indTbody = document.getElementById('industryGuaranteeTable');
            indTbody.innerHTML = top10Ind.map(stat => {
                const gStr = stat.guaranteed ? `${stat.guaranteed.count}æª” / å‡é«˜:${stat.guaranteed.avgHigh.toFixed(1)}` : '-';
                const ngStr = stat.notGuaranteed ? `${stat.notGuaranteed.count}æª” / å‡é«˜:${stat.notGuaranteed.avgHigh.toFixed(1)}` : '-';
                return `<tr>
                    <td style="text-align: left; padding-left: 10px; font-weight: bold;">${stat.name}</td>
                    <td>${stat.all.count}æª” / å‡é«˜:<strong style="color: #d32f2f;">${stat.all.avgHigh.toFixed(1)}</strong></td>
                    <td style="background: #e8f5e9;">${gStr}</td>
                    <td style="background: #fff3e0;">${ngStr}</td>
                </tr>`;
            }).join('');
            
            // åˆ¸å•†TOP10çš„æ“”ä¿äº¤å‰åˆ†æ
            const underwriters = [...new Set(mockData.map(d => d.underwriter))];
            const uwStats = underwriters.map(uw => {
                const all = mockData.filter(d => d.underwriter === uw);
                const guaranteed = all.filter(d => d.guarantee === 'æœ‰æ“”ä¿');
                const notGuaranteed = all.filter(d => d.guarantee === 'ç„¡æ“”ä¿');
                return {
                    name: uw,
                    all: calculateStats(all),
                    guaranteed: calculateStats(guaranteed),
                    notGuaranteed: calculateStats(notGuaranteed)
                };
            }).filter(s => s.all && s.all.count > 0);
            
            uwStats.sort((a, b) => b.all.avgHigh - a.all.avgHigh);
            const top10Uw = uwStats.slice(0, 10);
            
            const uwTbody = document.getElementById('underwriterGuaranteeTable');
            uwTbody.innerHTML = top10Uw.map(stat => {
                const gStr = stat.guaranteed ? `${stat.guaranteed.count}æª” / å‡é«˜:${stat.guaranteed.avgHigh.toFixed(1)}` : '-';
                const ngStr = stat.notGuaranteed ? `${stat.notGuaranteed.count}æª” / å‡é«˜:${stat.notGuaranteed.avgHigh.toFixed(1)}` : '-';
                return `<tr>
                    <td style="text-align: left; padding-left: 10px; font-weight: bold;">${stat.name}</td>
                    <td>${stat.all.count}æª” / å‡é«˜:<strong style="color: #d32f2f;">${stat.all.avgHigh.toFixed(1)}</strong></td>
                    <td style="background: #e8f5e9;">${gStr}</td>
                    <td style="background: #fff3e0;">${ngStr}</td>
                </tr>`;
            }).join('');
        }
        
        function initAllStats() {
            const total = mockData.length;
            const totalSize = mockData.reduce((s, d) => s + d.size, 0);
            const avgHigh = mockData.reduce((s, d) => s + d.high, 0) / total;
            const avgSwing = mockData.reduce((s, d) => {
                if (d.low > 0) return s + ((d.high - d.low) / d.low * 100);
                return s;
            }, 0) / total;
            
            document.getElementById('totalCount').textContent = total + 'æª”';
            document.getElementById('totalSize').textContent = totalSize.toFixed(1) + 'å„„';
            document.getElementById('avgHighAll').textContent = avgHigh.toFixed(1);
            document.getElementById('avgSwingAll').textContent = avgSwing.toFixed(1) + '%';
            
            generateBasicStats();
            generateSizeRangeStats();
            generateCapitalRangeStats();
            generateConvPriceRangeStats();
            generateUnderwriterTop10();
            generateIndustryTop10();
            generateCrossAnalysis();
        }
        
        async function loadExcelData() {
            try {
                const url = "https://rexdashu168.github.io/cbhistory168/cb_issue.xlsx";
                const response = await fetch(url + '?t=' + Date.now(), { cache: 'no-cache' });
                if (!response.ok) throw new Error('è¼‰å…¥å¤±æ•—');
                
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: "array" });
                const sheet = workbook.Sheets["allcbissue"];
                const jsonData = XLSX.utils.sheet_to_json(sheet);
                
                mockData = jsonData.map(row => ({
                    cbCode: String(row["CBä»£è™Ÿ"] || ""),
                    cbName: row["CBåç¨±"] || "",
                    stockCode: String(row["è‚¡ç¥¨ä»£è™Ÿ"] || ""),
                    size: parseFloat(row["ç™¼è¡Œè¦æ¨¡"] || 0),
                    guarantee: row["æœ‰ç„¡æ“”ä¿"] || "",
                    year: parseFloat(row["ç™¼è¡Œå¹´æœŸ"] || 0),
                    convPrice: parseFloat(row["è½‰æ›åƒ¹æ ¼"] || 0),
                    listDate: row["æ›ç‰Œæ—¥æœŸ"] || "",
                    high: parseFloat(row["æ›ç‰Œæœ€é«˜"] || 0),
                    low: parseFloat(row["æ›ç‰Œæœ€ä½"] || 0),
                    underwriter: row["æ‰¿éŠ·åˆ¸å•†"] || "",
                    industry: row["ç”¢æ¥­åˆ†é¡"] || "",
                    method: row["æ‰¿éŠ·æ–¹å¼"] || "",
                    capital: String(row["è‚¡æœ¬è¦æ¨¡"] || "")
                }));
                
                const dates = mockData.map(d => d.listDate).filter(d => d).sort();
                document.getElementById('statsBanner').innerHTML = 
                    `ğŸ“Š è³‡æ–™æœŸé–“: ${dates[0]} ~ ${dates[dates.length-1]},å…±è¨ˆ <strong>${mockData.length}</strong> æª”`;
                
                document.getElementById('loadingScreen').style.display = 'none';
                initAllStats();
                
            } catch (error) {
                document.getElementById('loadingScreen').innerHTML = '<div style="font-size: 1.5em;">è¼‰å…¥å¤±æ•—,è«‹é‡æ–°æ•´ç†é é¢</div>';
            }
        }
        
        window.addEventListener('DOMContentLoaded', loadExcelData);
    </script>
</body>
</html>
