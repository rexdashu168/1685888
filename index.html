<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ± - Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: #f5f5f5;
        }
        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px 20px 20px;
            text-align: center;
        }
        .header-section h1 { font-size: 1.8em; margin-bottom: 15px; }
        .stats-banner {
            background: linear-gradient(90deg, #ffe5b4 0%, #ffd89b 100%);
            padding: 15px 20px;
            text-align: center;
            color: #8b4513;
            font-weight: bold;
        }
        .function-menu {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 12px;
            padding: 15px 20px;
            max-width: 1400px;
            margin: 0 auto;
            background: #f8f9fa;
        }
        .function-item {
            text-align: center;
            cursor: pointer;
            padding: 15px 10px;
            border-radius: 10px;
            background: white;
            border: 2px solid #e0e0e0;
        }
        .function-item.active {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-color: #667eea;
        }
        .section-block { display: none; padding: 40px 20px; }
        .section-block.active { display: block; }
        .table-wrapper {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin: 20px auto;
            max-width: 1200px;
            background: white;
        }
        table { width: 100%; border-collapse: collapse; }
        thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        th { padding: 10px 6px; text-align: center; font-weight: bold; font-size: 0.9em; }
        td { padding: 8px 6px; text-align: center; border-bottom: 1px solid #eee; font-size: 0.9em; }
        tbody tr:hover { background: #f8f9fa; }
        .highlight-red { background: #d32f2f; color: white; }
    </style>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="header-section">
        <h1>CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ±</h1>
        <div>by Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</div>
    </div>

    <div class="stats-banner" id="statsBanner">ğŸ“Š è³‡æ–™è¼‰å…¥ä¸­...</div>

    <div class="function-menu">
        <div class="function-item" onclick="switchSection('section1', 0)">
            <div>ğŸ”</div><div>å–®æª”æŸ¥è©¢</div>
        </div>
        <div class="function-item active" onclick="switchSection('section8', 7)">
            <div>ğŸ“Š</div><div>å¸‚å ´çµ±è¨ˆ</div>
        </div>
    </div>

    <div class="content-section">
        <div id="section1" class="section-block">
            <div style="text-align:center; padding: 100px 20px; color:#999;">
                <div style="font-size: 3em;">ğŸ”</div>
                <div style="font-size: 1.2em;">å–®æª”æŸ¥è©¢åŠŸèƒ½ï¼ˆå·²ç°¡åŒ–ï¼‰</div>
            </div>
        </div>

        <!-- å¸‚å ´çµ±è¨ˆ -->
        <div id="section8" class="section-block active">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="color: #667eea; font-size: 2em;">ğŸ“Š å¸‚å ´çµ±è¨ˆç¸½è¦½</h2>
                <p style="color: #666; margin-top: 10px;">ç¬¬ä¸€éšæ®µï¼šåŸºç¤å€é–“çµ±è¨ˆåˆ†æï¼ˆæŒ‰å¹³å‡æœ€é«˜åƒ¹æ’åºï¼‰</p>
            </div>
            
            <!-- æ•´é«”æ¦‚æ³ -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin: 20px auto; max-width: 1200px;">
                <h3 style="margin-bottom: 15px;">ğŸŒ æ•´é«”å¸‚å ´æ¦‚æ³</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">CBç¸½æ•¸</div>
                        <div id="totalCount" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">ç¸½ç™¼è¡Œè¦æ¨¡</div>
                        <div id="totalSize" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æœ€é«˜åƒ¹</div>
                        <div id="avgHighAll" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æœ€ä½åƒ¹</div>
                        <div id="avgLowAll" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æŒ¯å¹…</div>
                        <div id="avgSwingAll" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                </div>
            </div>
            
            <!-- 1. ç™¼è¡Œè¦æ¨¡å€é–“ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px auto; max-width: 1200px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.3em;">ğŸ’¼ ç™¼è¡Œè¦æ¨¡å€é–“åˆ†æ</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>è¦æ¨¡å€é–“</th>
                                <th>CBæ•¸é‡</th>
                                <th>å¹³å‡è¦æ¨¡(å„„)</th>
                                <th class="highlight-red">å¹³å‡æœ€é«˜åƒ¹</th>
                                <th>å¹³å‡æœ€ä½åƒ¹</th>
                                <th>å¹³å‡æŒ¯å¹…(%)</th>
                            </tr>
                        </thead>
                        <tbody id="sizeRangeTable">
                            <tr><td colspan="7">è¼‰å…¥ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 2. è‚¡æœ¬å¤§å°å€é–“ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px auto; max-width: 1200px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.3em;">ğŸ¢ è‚¡æœ¬å¤§å°å€é–“åˆ†æ</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>è‚¡æœ¬å€é–“</th>
                                <th>CBæ•¸é‡</th>
                                <th>å¹³å‡è‚¡æœ¬(å„„)</th>
                                <th class="highlight-red">å¹³å‡æœ€é«˜åƒ¹</th>
                                <th>å¹³å‡æœ€ä½åƒ¹</th>
                                <th>å¹³å‡æŒ¯å¹…(%)</th>
                            </tr>
                        </thead>
                        <tbody id="capitalRangeTable">
                            <tr><td colspan="7">è¼‰å…¥ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 3. è½‰æ›åƒ¹æ ¼å€é–“ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px auto; max-width: 1200px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.3em;">ğŸ’± è½‰æ›åƒ¹æ ¼å€é–“åˆ†æ</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>è½‰æ›åƒ¹æ ¼å€é–“</th>
                                <th>CBæ•¸é‡</th>
                                <th>å¹³å‡è½‰æ›åƒ¹(å…ƒ)</th>
                                <th class="highlight-red">å¹³å‡æœ€é«˜åƒ¹</th>
                                <th>å¹³å‡æœ€ä½åƒ¹</th>
                                <th>å¹³å‡æŒ¯å¹…(%)</th>
                            </tr>
                        </thead>
                        <tbody id="convPriceRangeTable">
                            <tr><td colspan="7">è¼‰å…¥ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 4. æ‰¿éŠ·æ–¹å¼ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px auto; max-width: 1200px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.3em;">ğŸ“¢ æ‰¿éŠ·æ–¹å¼åˆ†æ</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>æ‰¿éŠ·æ–¹å¼</th>
                                <th>CBæ•¸é‡</th>
                                <th>å¹³å‡è¦æ¨¡(å„„)</th>
                                <th class="highlight-red">å¹³å‡æœ€é«˜åƒ¹</th>
                                <th>å¹³å‡æœ€ä½åƒ¹</th>
                                <th>å¹³å‡æŒ¯å¹…(%)</th>
                            </tr>
                        </thead>
                        <tbody id="methodTable">
                            <tr><td colspan="7">è¼‰å…¥ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 5. æ“”ä¿é¡å‹ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px auto; max-width: 1200px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.3em;">ğŸ›¡ï¸ æ“”ä¿é¡å‹åˆ†æ</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>æ“”ä¿é¡å‹</th>
                                <th>CBæ•¸é‡</th>
                                <th>å¹³å‡è¦æ¨¡(å„„)</th>
                                <th class="highlight-red">å¹³å‡æœ€é«˜åƒ¹</th>
                                <th>å¹³å‡æœ€ä½åƒ¹</th>
                                <th>å¹³å‡æŒ¯å¹…(%)</th>
                            </tr>
                        </thead>
                        <tbody id="guaranteeTable">
                            <tr><td colspan="7">è¼‰å…¥ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 6. ç°¡åŒ–åŸºæœ¬çµ±è¨ˆ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px auto; max-width: 1200px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.3em;">ğŸ“Š åŸºæœ¬æ¢ä»¶çµ±è¨ˆ</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>åˆ†é¡æ¢ä»¶</th>
                                <th>CBæ•¸é‡</th>
                                <th>ç¸½è¦æ¨¡(å„„)</th>
                                <th class="highlight-red">å¹³å‡æœ€é«˜åƒ¹</th>
                                <th>å¹³å‡æœ€ä½åƒ¹</th>
                                <th>å¹³å‡æŒ¯å¹…(%)</th>
                            </tr>
                        </thead>
                        <tbody id="basicStatsTable">
                            <tr><td colspan="7">è¼‰å…¥ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        let mockData = [];
        
        // æ¸¬è©¦è³‡æ–™
        function loadMockData() {
            mockData = [
                {cbCode: '29131', cbName: 'è¾²æ—ä¸€', stockCode: '2913', size: 7.5, guarantee: 'æœ‰æ“”ä¿', year: 3.0, convPrice: 17.8, high: 160.0, low: 99.5, capital: '79.0', method: 'è©¢åœˆ'},
                {cbCode: '62074', cbName: 'é›·ç§‘å››', stockCode: '6207', size: 6.0, guarantee: 'ç„¡æ“”ä¿', year: 5.0, convPrice: 53.6, high: 109.95, low: 99.0, capital: '7.97', method: 'è©¢åœˆ'},
                {cbCode: '23952', cbName: 'ç ”è¯äºŒ', stockCode: '2395', size: 8.0, guarantee: 'ç„¡æ“”ä¿', year: 3.0, convPrice: 94.04, high: 274.0, low: 104.0, capital: '85.8', method: 'è©¢åœˆ'},
                {cbCode: '30193', cbName: 'äºå…‰ä¸‰', stockCode: '3019', size: 10.0, guarantee: 'æœ‰æ“”ä¿', year: 3.0, convPrice: 58.5, high: 110.5, low: 96.2, capital: '27.9', method: 'è©¢åœˆ'}
            ];
            updateStatsBanner();
            initMarketStats();
        }
        
        // å¾GitHubè¼‰å…¥
        async function loadExcelData() {
            try {
                const url = "https://rexdashu168.github.io/cbhistory168/cb_issue.xlsx";
                const response = await fetch(url + '?t=' + Date.now(), { cache: 'no-cache', mode: 'cors' });
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: "array" });
                const sheet = workbook.Sheets["allcbissue"];
                const jsonData = XLSX.utils.sheet_to_json(sheet);
                
                mockData = jsonData.map(row => ({
                    cbCode: String(row["CBä»£è™Ÿ"] || ""),
                    cbName: row["CBåç¨±"] || "",
                    stockCode: String(row["è‚¡ç¥¨ä»£è™Ÿ"] || ""),
                    size: parseFloat(row["ç™¼è¡Œè¦æ¨¡"] || 0),
                    guarantee: row["æœ‰ç„¡æ“”ä¿"] || "",
                    year: parseFloat(row["ç™¼è¡Œå¹´æœŸ"] || 0),
                    convPrice: parseFloat(row["è½‰æ›åƒ¹æ ¼"] || 0),
                    high: parseFloat(row["æ›ç‰Œæœ€é«˜"] || 0),
                    low: parseFloat(row["æ›ç‰Œæœ€ä½"] || 0),
                    capital: String(row["è‚¡æœ¬è¦æ¨¡"] || ""),
                    method: row["æ‰¿éŠ·æ–¹å¼"] || ""
                }));
                
                updateStatsBanner();
                initMarketStats();
            } catch (error) {
                console.error('è¼‰å…¥å¤±æ•—ï¼Œä½¿ç”¨æ¸¬è©¦è³‡æ–™:', error);
                loadMockData();
            }
        }
        
        function updateStatsBanner() {
            document.getElementById('statsBanner').innerHTML = 
                `ğŸ“Š è³‡æ–™æœŸé–“: 2006~2025,å…±è¨ˆ <strong>${mockData.length}</strong> æª” | ğŸ’° æœ€å¾Œæ›´æ–°: ${new Date().toLocaleDateString('zh-TW')}`;
        }
        
        function switchSection(sectionId, index) {
            document.querySelectorAll('.section-block').forEach(block => block.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.function-item').forEach((item, i) => {
                if (i === index) item.classList.add('active');
                else item.classList.remove('active');
            });
            
            if (sectionId === 'section8') initMarketStats();
        }
        
        function calculateStats(data) {
            const count = data.length;
            if (count === 0) return { count: 0, totalSize: 0, avgSize: 0, avgHigh: 0, avgLow: 0, avgSwing: 0, avgValue: 0 };
            
            const totalSize = data.reduce((s, d) => s + d.size, 0);
            const avgSize = totalSize / count;
            const avgHigh = data.reduce((s, d) => s + d.high, 0) / count;
            const avgLow = data.reduce((s, d) => s + d.low, 0) / count;
            const avgSwing = data.reduce((s, d) => s + ((d.high - d.low) / d.low * 100), 0) / count;
            
            // è¨ˆç®—å¹³å‡è‚¡æœ¬ï¼ˆåƒ…ç•¶å€é–“çµ±è¨ˆæ™‚ä½¿ç”¨ï¼‰
            const avgCapital = data.reduce((s, d) => s + parseFloat(d.capital || 0), 0) / count;
            const avgConvPrice = data.reduce((s, d) => s + d.convPrice, 0) / count;
            
            return { 
                count, 
                totalSize, 
                avgSize, 
                avgHigh, 
                avgLow, 
                avgSwing,
                avgCapital,
                avgConvPrice
            };
        }
        
        function initMarketStats() {
            const total = mockData.length;
            const stats = calculateStats(mockData);
            
            document.getElementById('totalCount').textContent = total + 'æª”';
            document.getElementById('totalSize').textContent = stats.totalSize.toFixed(1) + 'å„„';
            document.getElementById('avgHighAll').textContent = stats.avgHigh.toFixed(1);
            document.getElementById('avgLowAll').textContent = stats.avgLow.toFixed(1);
            document.getElementById('avgSwingAll').textContent = stats.avgSwing.toFixed(1) + '%';
            
            // ç”Ÿæˆå„å€é–“çµ±è¨ˆ
            generateSizeRangeStats();
            generateCapitalRangeStats();
            generateConvPriceRangeStats();
            generateMethodStats();
            generateGuaranteeStats();
            generateBasicStats();
        }
        
        // 1. ç™¼è¡Œè¦æ¨¡å€é–“çµ±è¨ˆ
        function generateSizeRangeStats() {
            const ranges = [
                { label: '2å„„ä»¥ä¸‹', filter: d => d.size > 0 && d.size <= 2 },
                { label: '2-5å„„', filter: d => d.size > 2 && d.size <= 5 },
                { label: '5-10å„„', filter: d => d.size > 5 && d.size <= 10 },
                { label: '10-15å„„', filter: d => d.size > 10 && d.size <= 15 },
                { label: '15-20å„„', filter: d => d.size > 15 && d.size <= 20 },
                { label: '20å„„ä»¥ä¸Š', filter: d => d.size > 20 }
            ];
            
            const results = ranges.map(range => {
                const data = mockData.filter(range.filter);
                const stats = calculateStats(data);
                return { label: range.label, ...stats };
            }).filter(r => r.count > 0)
              .sort((a, b) => b.avgHigh - a.avgHigh);
            
            const tbody = document.getElementById('sizeRangeTable');
            tbody.innerHTML = results.map((r, i) => `
                <tr>
                    <td><strong>${i + 1}</strong></td>
                    <td style="text-align: left; padding-left: 10px;">${r.label}</td>
                    <td>${r.count}</td>
                    <td>${r.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold;">${r.avgHigh.toFixed(1)}</td>
                    <td>${r.avgLow.toFixed(1)}</td>
                    <td>${r.avgSwing.toFixed(1)}</td>
                </tr>
            `).join('');
        }
        
        // 2. è‚¡æœ¬å¤§å°å€é–“çµ±è¨ˆ
        function generateCapitalRangeStats() {
            const ranges = [
                { label: '3å„„ä»¥ä¸‹', filter: d => parseFloat(d.capital) > 0 && parseFloat(d.capital) <= 3 },
                { label: '3-6å„„', filter: d => parseFloat(d.capital) > 3 && parseFloat(d.capital) <= 6 },
                { label: '6-10å„„', filter: d => parseFloat(d.capital) > 6 && parseFloat(d.capital) <= 10 },
                { label: '10-15å„„', filter: d => parseFloat(d.capital) > 10 && parseFloat(d.capital) <= 15 },
                { label: '15-20å„„', filter: d => parseFloat(d.capital) > 15 && parseFloat(d.capital) <= 20 },
                { label: '20å„„ä»¥ä¸Š', filter: d => parseFloat(d.capital) > 20 }
            ];
            
            const results = ranges.map(range => {
                const data = mockData.filter(range.filter);
                const stats = calculateStats(data);
                return { label: range.label, ...stats };
            }).filter(r => r.count > 0)
              .sort((a, b) => b.avgHigh - a.avgHigh);
            
            const tbody = document.getElementById('capitalRangeTable');
            tbody.innerHTML = results.map((r, i) => `
                <tr>
                    <td><strong>${i + 1}</strong></td>
                    <td style="text-align: left; padding-left: 10px;">${r.label}</td>
                    <td>${r.count}</td>
                    <td>${r.avgCapital.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold;">${r.avgHigh.toFixed(1)}</td>
                    <td>${r.avgLow.toFixed(1)}</td>
                    <td>${r.avgSwing.toFixed(1)}</td>
                </tr>
            `).join('');
        }
        
        // 3. è½‰æ›åƒ¹æ ¼å€é–“çµ±è¨ˆ
        function generateConvPriceRangeStats() {
            const ranges = [
                { label: '20å…ƒä»¥ä¸‹', filter: d => d.convPrice > 0 && d.convPrice <= 20 },
                { label: '20-50å…ƒ', filter: d => d.convPrice > 20 && d.convPrice <= 50 },
                { label: '50-100å…ƒ', filter: d => d.convPrice > 50 && d.convPrice <= 100 },
                { label: '100-150å…ƒ', filter: d => d.convPrice > 100 && d.convPrice <= 150 },
                { label: '150-200å…ƒ', filter: d => d.convPrice > 150 && d.convPrice <= 200 },
                { label: '200å…ƒä»¥ä¸Š', filter: d => d.convPrice > 200 }
            ];
            
            const results = ranges.map(range => {
                const data = mockData.filter(range.filter);
                const stats = calculateStats(data);
                return { label: range.label, ...stats };
            }).filter(r => r.count > 0)
              .sort((a, b) => b.avgHigh - a.avgHigh);
            
            const tbody = document.getElementById('convPriceRangeTable');
            tbody.innerHTML = results.map((r, i) => `
                <tr>
                    <td><strong>${i + 1}</strong></td>
                    <td style="text-align: left; padding-left: 10px;">${r.label}</td>
                    <td>${r.count}</td>
                    <td>${r.avgConvPrice.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold;">${r.avgHigh.toFixed(1)}</td>
                    <td>${r.avgLow.toFixed(1)}</td>
                    <td>${r.avgSwing.toFixed(1)}</td>
                </tr>
            `).join('');
        }
        
        // 4. æ‰¿éŠ·æ–¹å¼çµ±è¨ˆ
        function generateMethodStats() {
            const methods = [...new Set(mockData.map(d => d.method))].filter(m => m);
            
            const results = methods.map(method => {
                const data = mockData.filter(d => d.method === method);
                const stats = calculateStats(data);
                return { label: method, ...stats };
            }).sort((a, b) => b.avgHigh - a.avgHigh);
            
            const tbody = document.getElementById('methodTable');
            tbody.innerHTML = results.map((r, i) => `
                <tr>
                    <td><strong>${i + 1}</strong></td>
                    <td style="text-align: left; padding-left: 10px;">${r.label}</td>
                    <td>${r.count}</td>
                    <td>${r.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold;">${r.avgHigh.toFixed(1)}</td>
                    <td>${r.avgLow.toFixed(1)}</td>
                    <td>${r.avgSwing.toFixed(1)}</td>
                </tr>
            `).join('');
        }
        
        // 5. æ“”ä¿é¡å‹çµ±è¨ˆ
        function generateGuaranteeStats() {
            const types = [...new Set(mockData.map(d => d.guarantee))].filter(g => g);
            
            const results = types.map(type => {
                const data = mockData.filter(d => d.guarantee === type);
                const stats = calculateStats(data);
                return { label: type, ...stats };
            }).sort((a, b) => b.avgHigh - a.avgHigh);
            
            const tbody = document.getElementById('guaranteeTable');
            tbody.innerHTML = results.map((r, i) => `
                <tr>
                    <td><strong>${i + 1}</strong></td>
                    <td style="text-align: left; padding-left: 10px;">${r.label}</td>
                    <td>${r.count}</td>
                    <td>${r.avgSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold;">${r.avgHigh.toFixed(1)}</td>
                    <td>${r.avgLow.toFixed(1)}</td>
                    <td>${r.avgSwing.toFixed(1)}</td>
                </tr>
            `).join('');
        }
        
        // 6. åŸºæœ¬æ¢ä»¶çµ±è¨ˆï¼ˆè¦æ¨¡â‰¥10å„„ vs <10å„„ç­‰ï¼‰
        function generateBasicStats() {
            const conditions = [
                { label: 'è¦æ¨¡â‰¥10å„„', filter: d => d.size >= 10 },
                { label: 'è¦æ¨¡<10å„„', filter: d => d.size < 10 },
                { label: 'è½‰æ›åƒ¹â‰¥100å…ƒ', filter: d => d.convPrice >= 100 },
                { label: 'è½‰æ›åƒ¹<100å…ƒ', filter: d => d.convPrice < 100 },
                { label: 'è‚¡æœ¬â‰¥10å„„', filter: d => parseFloat(d.capital) >= 10 },
                { label: 'è‚¡æœ¬<10å„„', filter: d => parseFloat(d.capital) < 10 }
            ];
            
            const results = conditions.map(cond => {
                const data = mockData.filter(cond.filter);
                const stats = calculateStats(data);
                return { label: cond.label, ...stats };
            }).filter(r => r.count > 0)
              .sort((a, b) => b.avgHigh - a.avgHigh)
              .slice(0, 6);
            
            const tbody = document.getElementById('basicStatsTable');
            tbody.innerHTML = results.map((r, i) => `
                <tr>
                    <td><strong>${i + 1}</strong></td>
                    <td style="text-align: left; padding-left: 10px;">${r.label}</td>
                    <td>${r.count}</td>
                    <td>${r.totalSize.toFixed(1)}</td>
                    <td style="color: #d32f2f; font-weight: bold;">${r.avgHigh.toFixed(1)}</td>
                    <td>${r.avgLow.toFixed(1)}</td>
                    <td>${r.avgSwing.toFixed(1)}</td>
                </tr>
            `).join('');
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            loadExcelData();
        });
    </script>
</body>
</html>
